<html><head><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="Content-Language" content="en-US"><title>2377 -- Bad Cowtractors</title><link rel=stylesheet href='poj.css' type='text/css'><link rel='shortcut icon' href='poj.ico'><link rel='icon' href='http://poj.org/poj.gif' type='image/gif'><script src='poj.js' language='javascript'></script></head><body lang="en-US" leftmargin=5 link=blue alink=blue vlink=blue onkeydown=KeyDown(event)><a name=top></a><TABLE style='BORDER-COLLAPSE: collapse' borderColor=#ffffff width=100% border=1><TBODY><TR><TD align=CENTER colSpan=5><table class=h1 cellpadding=0><tr><td width=25% align=left><img src='images/logo1.jpg' height=100 border=0></td><td colspan=3 bgcolor='#EAEFFD'><table class=h2><tr><td><img border=0 src='images/logo0.gif' width=450 height=90></td><td width=95><img border=0 src='images/logo3.gif' width=95 height=95></td></tr></table></td></tr></table></TD></TR><TR vAlign=top align=CENTER bgColor=#6589d1><TH class=h>Online Judge</TH><TH class=h>Problem Set</TH><TH class=h>Authors</TH><TH class=h>Online Contests</TH><TH class=h>User</TH></TR><TR vAlign=top align=CENTER bgColor='#f1f1fd'><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><A href='http://poj.org/bbs'>Web Board</A><BR><A href='http://poj.org/'>Home Page</A><BR><A href='http://poj.org/page?id=1000' target=_blank>F.A.Qs</A><BR><a href='http://poj.org/chart'>Statistical Charts</a></TD><TD class='h' onMouseOver='scbg(this, 1)' onMouseOut='scbg(this, 0)'><FORM action="http://poj.org/gotoproblem" method=get><A href='http://poj.org/problemlist'>Problems</A><BR><A href='http://poj.org/submit'>Submit Problem</A><BR><A href='http://poj.org/status'>Online Status</A><BR><font color=blue>Prob.ID:</font><input type=text name=pid size=6><input type=Submit value=Go name=pb1></form></td><TD class='h' onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=GET action="http://poj.org/searchuser"><a href="http://poj.org/register">Register</a><br><a href="http://poj.org/modifyuser">Update your info</a><br><a href="http://poj.org/userlist">Authors ranklist</a><br><input type=text name=key size=10><input type=Submit value=Search name=B1></form></TD>
<TD class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><font color=#1a5cc8>Current Contest</font><br><a href="http://poj.org/pastcontests">Past Contests</a><br><a href="http://poj.org/contests">Scheduled Contests</a><br><a href="http://poj.org/challenge.html" target=_blank><font color=red>Award Contest</font></a></td><TD align=left class=h onMouseOver='scbg(this,1)' onMouseOut='scbg(this,0)'><form method=POST action="http://poj.org/login"><table><tr><td>User ID:</td><td><input type=text name=user_id1 size=10 style='font-family:monospace'></td></tr><tr><td>Password:</td><td><input type=password name=password1 size=10 style='font-family:monospace'></td></tr></table><input type=Submit value=login name=B1>&nbsp;&nbsp;<a href="http://poj.org/register" target=_parent>Register</a><input type=hidden name=url value=/problem?id=2377></form></td></TR></TABLE><MARQUEE SCROLLAMOUNT=3 BEHAVIOR=ALTERNATE SCROLLDELAY=150><font color=red><div>
<img style="float:left;width: 105px;" src="http://static.hihocoder.com/images/logo.png">
<div style="float:left;margin-top:5px;margin-left:5px;"><a style="color:#D73636;" target="_blank" 
href="http://hihocoder.com/contests">hihoCoder挑战赛11来啦！有Tshirt作为奖品哦~</a></div>
<div style="clear:both;"></div>
</div></font></MARQUEE><table border=0 width=100% background="images/table_back.jpg"><tr><td>
<div style='position: absolute; right: 10px;'>Language:<select size=1 onChange="window.location.href='problem?id=2377&lang='+this.value+'&change=true'"><option value='default' selected>Default</option></select></div><div class="ptt" lang="en-US">Bad Cowtractors</div>
<div class="plm"><table align="center"><tr><td><b>Time Limit:</b> 1000MS</td><td width="10px"></td><td><b>Memory Limit:</b> 65536K</td></tr><tr><td><b>Total Submissions:</b> 11424</td><td width="10px"></td><td><b>Accepted:</b> 4781</td></table></div><p class="pst">Description</p><div class="ptx" lang="en-US">Bessie has been hired to build a cheap internet network among Farmer John's N (2 <= N <= 1,000) barns that are conveniently numbered 1..N. FJ has already done some surveying, and found M (1 <= M <= 20,000) possible connection routes between pairs of barns.  Each possible connection route has an associated cost C (1 <= C <= 100,000).  Farmer John wants to spend the least amount on connecting the network; he doesn't even want to pay Bessie.<br><br>Realizing Farmer John will not pay her, Bessie decides to do the worst job possible.  She must decide on a set of connections to install so that (i) the total cost of these connections is as large as possible, (ii) all the barns are connected together (so that it is possible to reach any barn from any other barn via a path of installed connections), and (iii) so that there are no cycles among the connections (which Farmer John would easily be able to detect). Conditions (ii) and (iii) ensure that the final set of connections will look like a "tree".</div><p class="pst">Input</p><div class="ptx" lang="en-US">* Line 1: Two space-separated integers: N and M<br><br>* Lines 2..M+1: Each line contains three space-separated integers A, B, and C that describe a connection route between barns A and B of cost C.</div><p class="pst">Output</p><div class="ptx" lang="en-US">* Line 1: A single integer, containing the price of the most expensive tree connecting all the barns.  If it is not possible to connect all the barns, output -1.</div><p class="pst">Sample Input</p><pre class="sio">5 8
1 2 3
1 3 7
2 3 10
2 4 4
2 5 8
3 4 6
3 5 2
4 5 17</pre><p class="pst">Sample Output</p><pre class="sio">42</pre><p class="pst">Hint</p><div class="ptx" lang="en-US">OUTPUT DETAILS:<br><br>The most expensive tree has cost 17 + 8 + 10 + 7 = 42.  It uses the following connections: 4 to 5, 2 to 5, 2 to 3, and 1 to 3.</div><p class="pst">Source</p><div class="ptx" lang="en-US"><a href="http://poj.org/searchproblem?field=source&amp;key=USACO+2004+December+Silver">USACO 2004 December Silver</a></div></td></tr></table>
<font color=#333399 size=3><p align="center">
[<a href="http://poj.org/submit?problem_id=2377">Submit</a>]&nbsp;&nbsp;
 [<a href="javascript:history.go(-1)">Go Back</a>]&nbsp;&nbsp; [<a href="http://poj.org/problemstatus?problem_id=2377">Status</a>]&nbsp;&nbsp; 
[<a href="http://poj.org/bbs?problem_id=2377">Discuss</a>]
</font></p>
<p><img height=30 src="images/home.gif" width=40 border=0><font size=3><a href="http://poj.org/">Home Page</a> </font>&nbsp;&nbsp;<img height=30 src='images/goback.gif' width=40 border=0><font size=3><a href='javascript:history.go(-1)'>Go Back</a>&nbsp;&nbsp;<img height=30 width=40 border=0 src='images/top.gif'><a href="problem?id=2377#top">To top</a></font><br><hr><P align=center style='font-family:Arial, Helvetica, sans-serif'>All Rights Reserved 2003-2013 Ying Fuchen,Xu Pengcheng,Xie Di<br>Any problem, Please <a href=mailto:webmaster@poj.org>Contact Administrator</a></p><script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-790353-1']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script></body></html>
